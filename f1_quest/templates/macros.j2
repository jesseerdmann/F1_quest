{% macro render_table(base_url, table) %}
<table class="table">
    <h5>{{ table.name }}</h5>
    <thead>
        <tr>
            <th scope="col">Position</th>
            <th scope="col">{{ table.subject_label }}</th>
            <th scope="col">{{ table.score_label }}</th>
            {% if table.show_values %}
            <th scope="col">{{ table.value_label }}</th>
            {% endif %}
            {% if table.show_entries %}
            <th scope="col">{{ table.entry_label }}</th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
        {% for table_row in table.get_ordered_subjects() %}
        <tr class="{{ loop.cycle('table-light', 'table-secondary') }}">
            <th scope="row">
            {% if loop.first or loop.previtem.pos != table_row.pos %}
            {{ table_row.pos }}
            {% endif %}
            </th>
            {% if table.subject_label == 'Driver' %}
            <td><a class="text-danger" href="{{ driver_url(base_url, table_row.subject|string) }}">{{ table_row.subject|string }}</a></td>
            {% elif table.subject_label == 'Entry' %}
            <td><a class="text-danger" href="{{ entry_url(base_url, table_row.subject|string) }}">{{ table_row.subject|string }}</a></td>
            {% elif table.subject_label == 'Race' %}
            <td><a class="text-danger" href="{{ race_url(base_url, table_row.subject|string) }}">{{ table_row.subject|string }}</a></td>
            {% elif table.subject_label == 'Team' %}
            <td><a class="text-danger" href="{{ team_url(base_url, table_row.subject|string) }}">{{ table_row.subject|string }}</a></td>
            {% endif %}
            <td>{{ table_row.score }}</td>
            {% if table.show_values %}
            <td scope="col">{{ table_row.value }}</td>
            {% endif %}
            {% if table.show_entries %}
            <td scope="col">
            {% for entry in table_row.matching_entries %}
            <a class="text-danger" href="{{ entry_url(base_url, entry|string) }}">{{ entry }}</a>{% if not loop.last %}, {% endif %}
            {% if table.tie_breaker_var is not none %}
            (TB: {{ entry.__dict__[table.tie_breaker_var]}})
            {% endif %}
            {% endfor %}
            </td>
            {% endif %}
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endmacro %}

{% macro entry_url(base_url, entry_name) -%}
    {{ base_url }}/entries/{{ entry_name.replace(' ', '_') }}.html
{%- endmacro %}

{% macro result_url(base_url, result_name) -%}
    {{ base_url }}/results/{{ result_name.replace(':', '').replace(' ', '_') }}.html
{%- endmacro %}

{% macro driver_url(base_url, driver_name) -%}
    {{ base_url }}/drivers/{{ driver_name.replace(', ', '_').replace(' ', '_') }}.html
{%- endmacro %}

{% macro team_url(base_url, team_name) -%}
    {{ base_url }}/teams/{{ team_name.replace(' ', '_') }}.html
{%- endmacro %}

{% macro race_url(base_url, race_string) -%}
    {{ base_url }}/races/{{ race_string.replace(' @ ', '_').replace(':', '_').replace('/', '_').replace(' ', '_') }}.html
{%- endmacro %}